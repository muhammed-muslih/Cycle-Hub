<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"/>
<style>
    .card {
        /* background-color: #fff; */
        border-radius: 10px;
        border: none;
        position: relative;
        margin-bottom: 30px;
        box-shadow: 0 0.46875rem 2.1875rem rgba(90, 97, 105, 0.1), 0 0.9375rem 1.40625rem rgba(90, 97, 105, 0.1), 0 0.25rem 0.53125rem rgba(90, 97, 105, 0.12), 0 0.125rem 0.1875rem rgba(90, 97, 105, 0.1);
    }
    .l-bg-cherry {
        background: linear-gradient(to right, #493240, #f09) !important;
        color: #fff;
    }

    .l-bg-blue-dark {
        background: linear-gradient(to right, #373b44, #4286f4) !important;
        color: #fff;
    }

    .l-bg-green-dark {
        background: linear-gradient(to right, #0a504a, #38ef7d) !important;
        color: #fff;
    }

    .l-bg-orange-dark {
        background: linear-gradient(to right, #a86008, #ffba56) !important;
        color: #fff;
    }
    

    .card .card-statistic-3 .card-icon-large .fas,
    .card .card-statistic-3 .card-icon-large .far,
    .card .card-statistic-3 .card-icon-large .fab,
    .card .card-statistic-3 .card-icon-large .fal {
        font-size: 110px;
    }

    .card .card-statistic-3 .card-icon {
        text-align: center;
        line-height: 50px;
        margin-left: 15px;
        color: #000;
        position: absolute;
        right: -5px;
        top: 20px;
        opacity: 0.1;
    }

    /* .l-bg-cyan {
        background: linear-gradient(135deg, #289cf5, #84c0ec) !important;
        color: #fff;
    }

    .l-bg-green {
        background: linear-gradient(135deg, #23bdb8 0%, #43e794 100%) !important;
        color: #fff;
    }

    .l-bg-orange {
        background: linear-gradient(to right, #f9900e, #ffba56) !important;
        color: #fff;
    }

    .l-bg-cyan {
        background: linear-gradient(135deg, #289cf5, #84c0ec) !important;
        color: #fff;
    } */
</style>
<div class="content">

    <section class="mt-5">
        <div class="col-md-12 ">
            <div class="row ">
                <div class="col-xl-3 col-lg-6">
                    <div class="card l-bg-cherry">
                        <div class="card-statistic-3 p-4">
                            <div class="card-icon card-icon-large">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="mb-4">
                                <h5 class="card-title mb-0">Completed Orders</h5>
                            </div>
                            <div class="row align-items-center mb-2 d-flex">
                                <div class="col-8">
                                    <h2 class="d-flex align-items-center mb-0">
                                        <%=locals.deliverdOrders%> 
                                    </h2>
                                </div>
                                <!-- <div class="col-4 text-right">
                                    <span>12.5%
                                        <i class="fa fa-arrow-up"></i>
                                    </span>
                                </div> -->
                            </div>
                            <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                                <div class="progress-bar l-bg-cyan" role="progressbar" data-width="100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-6">
                    <div class="card l-bg-blue-dark">
                        <div class="card-statistic-3 p-4">
                            <div class="card-icon card-icon-large">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="mb-4">
                                <h5 class="card-title mb-0">Total Customers</h5>
                            </div>
                            <div class="row align-items-center mb-2 d-flex">
                                <div class="col-8">
                                    <h2 class="d-flex align-items-center mb-0">
                                        <%=locals.totalCustomers%>
                                    </h2>
                                </div>
                                <!-- <div class="col-4 text-right">
                                    <span>9.23%
                                        <i class="fa fa-arrow-up"></i>
                                    </span>
                                </div> -->
                            </div>
                            <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                                <div class="progress-bar l-bg-green" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-6">
                    <div class="card l-bg-green-dark">
                        <div class="card-statistic-3 p-4">
                            <div class="card-icon card-icon-large">
                                <i class="fas fa-ticket-alt"></i>
                            </div>
                            <div class="mb-4">
                                <h5 class="card-title mb-0">Total Products</h5>
                            </div>
                            <div class="row align-items-center mb-2 d-flex">
                                <div class="col-8">
                                    <h2 class="d-flex align-items-center mb-0">
                                        <%=locals.totalProducts%>
                                    </h2>
                                </div>
                                <!-- <div class="col-4 text-right">
                                    <span>10%
                                        <i class="fa fa-arrow-up"></i>
                                    </span>
                                </div> -->
                            </div>
                            <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                                <div class="progress-bar l-bg-orange" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                            </div> -->
                        </div>
                    </div>
                </div>


                <div class="col-xl-3 col-lg-6">
                  <div class="card l-bg-orange-dark">
                      <div class="card-statistic-3 p-4">
                          <div class="card-icon card-icon-large">
                              <i class="fas fa-dollar-sign"></i>
                          </div>
                          <div class="mb-4">
                              <h5 class="card-title mb-0">Total Revenue</h5>
                          </div>
                          <div class="row align-items-center mb-2 d-flex">
                              <div class="col-8">
                                  <h2 class="d-flex align-items-center mb-0">
                                      <%=locals.totalSale%>
                                  </h2>
                              </div>
                              <!-- <div class="col-4 text-right">
                                  <span>2.5%
                                      <i class="fa fa-arrow-up"></i>
                                  </span>
                              </div> -->
                          </div>
                          <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                              <div class="progress-bar l-bg-cyan" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                          </div> -->
                      </div>
                  </div>
              </div>


                <div class="col-xl-3 col-lg-6">
                    <div class="card l-bg-orange-dark">
                        <div class="card-statistic-3 p-4">
                            <div class="card-icon card-icon-large">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="mb-4">
                                <h5 class="card-title mb-0">Revenue Today</h5>
                            </div>
                            <div class="row align-items-center mb-2 d-flex">
                                <div class="col-8">
                                    <h2 class="d-flex align-items-center mb-0">
                                        <%=locals.todaysAmount%>
                                    </h2>
                                </div>
                                <!-- <div class="col-4 text-right">
                                    <span>2.5%
                                        <i class="fa fa-arrow-up"></i>
                                    </span>
                                </div> -->
                            </div>
                            <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                                <div class="progress-bar l-bg-cyan" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                            </div> -->
                        </div>
                    </div>
                </div>


                <div class="col-xl-3 col-lg-6">
                  <div class="card l-bg-orange-dark">
                      <div class="card-statistic-3 p-4">
                          <div class="card-icon card-icon-large">
                              <i class="fas fa-dollar-sign"></i>
                          </div>
                          <div class="mb-4">
                              <h5 class="card-title mb-0">This week Revenue</h5>
                          </div>
                          <div class="row align-items-center mb-2 d-flex">
                              <div class="col-8">
                                  <h2 class="d-flex align-items-center mb-0">
                                      <%=locals.weekSale%>
                                  </h2>
                              </div>
                              <!-- <div class="col-4 text-right">
                                  <span>2.5%
                                      <i class="fa fa-arrow-up"></i>
                                  </span>
                              </div> -->
                          </div>
                          <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                              <div class="progress-bar l-bg-cyan" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                          </div> -->
                      </div>
                  </div>
              </div>


              <div class="col-xl-3 col-lg-6">
                <div class="card l-bg-orange-dark">
                    <div class="card-statistic-3 p-4">
                        <div class="card-icon card-icon-large">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="mb-4">
                            <h5 class="card-title mb-0">This Month Revenue</h5>
                        </div>
                        <div class="row align-items-center mb-2 d-flex">
                            <div class="col-8">
                                <h2 class="d-flex align-items-center mb-0">
                                    <%=locals.monthlyAmount%>
                                </h2>
                            </div>
                            <!-- <div class="col-4 text-right">
                                <span>2.5%
                                    <i class="fa fa-arrow-up"></i>
                                </span>
                            </div> -->
                        </div>
                        <!-- <div class="progress mt-1 " data-height="8" style="height: 8px;">
                            <div class="progress-bar l-bg-cyan" role="progressbar" data-width="25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: 25%;"></div>
                        </div> -->
                    </div>
                </div>
             </div>


             <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-orange-dark">
                  <div class="card-statistic-3 p-4">
                      <div class="card-icon card-icon-large">
                          <i class="fas fa-dollar-sign"></i>
                      </div>
                      <div class="mb-4">
                          <h5 class="card-title mb-0">This Year  Revenue</h5>
                      </div>
                      <div class="row align-items-center mb-2 d-flex">
                          <div class="col-8">
                              <h2 class="d-flex align-items-center mb-0">
                                  <%=locals.yearAmount%>
                              </h2>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
        </div>
        </div>

    </section>


    <div class="row mt-2">
        <div class="col-12">
            <div class="card card-chart">
                <div class="card-header ">
                    <div class="row">
                        <div class="col-sm-8 text-left">
                            <h5 class="card-category">Monthly Revenue</h5>
                            <h2 class="card-title">Performance</h2>
                        </div>
                        <div class="col-sm-4 text-left">
                          <h5 class="card-category">order Details</h5>
                          <h2 class="card-title">Performance</h2>
                      </div>
                        <div class="col-md-8 text-left">
                          <div class="card-body">
                            <canvas id="monthlyChart"></canvas>
                          </div> 
                        </div>
                        <div class="col-md-4 text-left">
                          <div class="card-body">
                            <canvas id="orderStatusChart"></canvas>
                          </div> 
                        </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

  

(async () => {

  try{
    const res = await axios({
      method:'get',
      url:'/admin/getDashboardData'
    })

    const salesPerMonth = res.data.salesPerMonth
    let amountofSalesPerMonth = [0,0,0,0,0,0,0,0,0,0,0,0]
    salesPerMonth.forEach(sales => {
      amountofSalesPerMonth[ sales._id-1 ]= sales.sale
      
    });
    console.log(amountofSalesPerMonth);

    const orderStatusDetails = res.data.orderStatusDetails
    console.log(orderStatusDetails);
     let orderStatuses=[];
     let orderStatusCount=[]

     orderStatusDetails.forEach(order=>{
      orderStatuses.push(order._id)
      orderStatusCount.push(order.count)
     })

     const monthlysales = document.getElementById('monthlyChart');
        new Chart(monthlysales, {
         type: 'bar',
         data: {
           labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
           datasets: [{
             label: 'â‚¹amount per month',
             data: amountofSalesPerMonth,
             borderWidth: 1,
             backgroundColor:' lightGreen',
             
           }]
         },
         options: {
           scales: {
             y: {
               beginAtZero: true
             }
           }
         }
       });



       const orderStatus = document.getElementById('orderStatusChart')
       new Chart(orderStatus,{
        type: 'pie',
         data: {
          labels: orderStatuses,
            datasets: [
              {
                label: 'Dataset 1',
                data: orderStatusCount,
                
              }
            ]
         },

         options: {
           responsive: true,
           plugins: {
             legend: {
               position: 'top',
             },
             title: {
               display: true,
               text: 'Order Details'
             },
             colors: {
               enabled: true,
             },

           }
         }
       })

  }catch(err){

    console.log(err);

  }


 

})();
</script>
    